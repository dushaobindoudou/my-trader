# 个人交易决策辅助知识库 - 需求规格说明书

## 文档信息
- **文档版本**: 1.0
- **创建日期**: 2024年
- **文档类型**: 需求规格说明书
- **目标用户**: 个人交易者

## 1. 项目概述

### 1.1 项目背景
本项目旨在构建一个轻量级的个人投资信息记录与分析系统，通过结构化的手动录入方式，特别是机构成本信息的收集，构建高质量的个人知识库。系统利用大语言模型（LLM）的阅读和总结能力，为个人交易者提供趋势投资决策辅助。

### 1.2 设计理念
系统设计遵循以下核心理念：
- **简化操作**：避免复杂系统和实时数据依赖
- **结构化录入**：聚焦核心信息（机构成本）和分类管理
- **智能分析**：利用多模型对比分析提升决策质量

### 1.3 项目目标
构建一个轻量级的个人投资信息记录与分析系统，支持用户手动录入文本信息并进行严格分类。核心目标是帮助用户跟踪和分析大机构的持仓成本，结合其他信息，利用多个LLM模型生成趋势分析参考。

## 2. 功能性需求

### 2.1 需求分类说明
- **F-REQ**: 功能性需求 (Functional Requirements)
- **NF-REQ**: 非功能性需求 (Non-Functional Requirements)

### 2.2 模块一：知识库管理

#### 2.2.1 信息录入功能

**F-REQ 1.1: 核心录入功能**
- 系统应提供简洁明了的文本录入界面
- 支持用户自由输入各类信息，包括但不限于：
  - 新闻摘要
  - 研报观点
  - 个人思考
  - 市场传闻
- **版本约束**: V1.0仅支持纯文本录入，暂不支持文件上传、图片或网页抓取功能

**F-REQ 1.2: 核心分类功能**
- 用户在保存信息时必须选择主分类
- 主分类为系统预设，不可由用户随意添加
- **预设主分类列表**：
  1. **机构成本** - 核心需求分类
  2. **市场新闻** - 宏观或特定资产相关新闻
  3. **研报观点** - 机构研报核心结论摘要
  4. **宏观数据** - CPI、PMI、利率决议等数据记录
  5. **个人见解** - 用户交易日志、思考或策略

**F-REQ 1.3: 标签功能**
- 支持用户为信息添加多个标签，便于交叉检索
- 标签功能为推荐功能，非强制要求
- 支持用户自由创建标签
- **标签分类示例**：
  - **资产标签**: BTC、黄金、AAPL、英伟达
  - **机构标签**: 高盛、桥水、贝莱德
  - **情绪标签**: 看多、看空、中性
  - **来源标签**: Bloomberg、Twitter-KOL、私享会

**F-REQ 1.4: 机构成本优化录入**
- **简化方式**: 用户选择"机构成本"分类后，在文本框中按格式录入
  - 录入格式示例："资产: BTC, 机构: 贝莱德, 成本价: 约 $60,000, 来源: 链上数据分析, 备注: ..."
- **结构化方式**: 选择"机构成本"分类时，可选显示专用字段
  - 资产/标的
  - 机构名称
  - 成本价格/区间
  - 主文本框用于填写来源/备注

**F-REQ 1.5: 信息检索与过滤**
- 系统应提供信息浏览界面（列表形式）
- 支持组合过滤功能查看已录入信息
- **过滤条件要求**：
  - 按主分类过滤（如：仅显示"机构成本"）
  - 按标签过滤（如：仅显示"BTC"相关）
  - 组合过滤（如：显示"BTC"相关的"机构成本"和"研报观点"）
  - 按时间范围过滤（最近7天、最近30天、自定义日期范围）
- 支持时间排序（默认倒序，可选正序）
- **列表显示字段**：主分类、标签（前3个）、内容摘要（前100字）、创建时间

**F-REQ 1.6: 信息编辑与删除**
- 支持编辑已录入信息（内容、分类、标签）
- 支持删除信息（需二次确认防误删）
- 自动记录创建时间和最后修改时间

**F-REQ 1.7: 全文搜索**
- 提供关键词搜索功能
- 搜索结果可与过滤条件结合使用
- **版本约束**: V1.0仅支持简单文本匹配，暂不支持复杂全文索引

**F-REQ 1.8: 数据导出与备份**
- 支持数据导出（JSON或CSV格式）
- 支持筛选后数据导出
- 目的：便于个人备份和数据迁移

### 2.3 模块二：多模型分析

#### 2.3.1 分析功能

**F-REQ 2.1: 上下文选择**
- 用户发起分析前需手动选择信息范围
- 实现方式：在检索界面筛选信息后，点击"使用这些信息进行分析"
- 示例：筛选过去3个月关于"AAPL"的"机构成本"和"研报观点"

**F-REQ 2.2: 分析请求**
- 提供提问界面
- 用户输入分析问题（Prompt）
- 支持选择Agent配置（不同的分析角色和风格）
- 支持选择多个LLM模型同时分析
- 示例问题："基于提供的信息，总结市场对AAPL的主要分歧点，并列出机构成本区间"

**F-REQ 2.3: 结果对比**
- 将选定信息和问题发送给所选LLM
- 分析结果并排显示，便于对比不同模型的分析逻辑
- 界面布局：左侧模型A回答，右侧模型B回答

**F-REQ 2.4: 分析历史**
- 保存分析请求和多模型结果
- 历史记录包含：提问内容、上下文信息（信息ID列表）、使用的Agent配置、各模型回答、创建时间
- 支持历史记录查看、搜索和时间排序

**F-REQ 2.5: LLM配置管理**
- 提供配置界面，支持添加/编辑/删除LLM模型配置
- 配置项：模型名称、API密钥、API端点URL
- **版本约束**: V1.0支持OpenAI兼容API

**F-REQ 2.6: Agent配置管理**
- 提供Agent配置界面，支持添加/编辑/删除Agent配置
- 配置项：Agent名称、描述、系统提示词、是否默认、是否启用
- 预设Agent类型：
  - **趋势分析师**：专注于市场趋势和价格走势分析
  - **风险控制师**：专注于风险评估和资金管理建议
  - **数据研究员**：专注于数据解读和量化分析
  - **宏观分析师**：专注于宏观经济和政策影响分析
- 支持自定义Agent：用户可创建专属的分析角色
- 支持系统提示词编辑：提供富文本编辑器，支持实时预览

## 3. 非功能性需求

### 3.1 易用性要求
- **NF-REQ 3.1: 简洁易用**
  - 界面设计简洁明了，操作路径清晰
  - 录入、分类、筛选、分析操作不超过3次点击

### 3.2 安全与隐私
- **NF-REQ 3.2: 隐私与安全**
  - 所有录入信息（特别是"个人见解"和"机构成本"）视为高度机密
  - 系统确保数据隔离和安全存储

### 3.3 性能要求
- **NF-REQ 3.3: 响应速度**
  - 知识库过滤和检索在万条记录内实现毫秒级响应
  - 系统本身不增加LLM分析额外延迟

### 3.4 数据管理
- **NF-REQ 3.4: 数据持久化**
  - 所有数据可靠存储，系统重启后数据不丢失
  - 建议使用轻量级本地数据库（如SQLite）

### 3.5 系统架构
- **NF-REQ 3.5: 单用户设计**
  - V1.0仅支持单用户本地使用
  - 无需考虑多用户、权限管理等复杂场景

## 4. 设计原则与核心理念

### 4.1 简化原则
- **保持简单**: 复杂系统会增加录入摩擦力，影响用户使用体验
- **手动录入**: "手动 + 纯文本"是项目启动的最佳选择
- **降低门槛**: 避免因操作复杂导致用户放弃使用

### 4.2 分类管理
- **分类为核心**: 信息分类是知识库管理的灵魂
- **结构化存储**: 无分类的知识库无法有效利用
- **二级结构**: "主分类 + 标签"结构兼顾结构性和灵活性

### 4.3 机构成本导向
- **核心参考**: 将"机构成本"作为核心参考指标
- **风险控制**: 基于成熟的风险控制思路
- **事实基础**: 为LLM提供"地基"（Ground Truth），确保分析基于事实而非预测

### 4.4 系统定位
- **第二大脑**: 系统作为用户专属的结构化知识库
- **智能分析**: LLM作为处理信息的"分析师团队"
- **决策辅助**: 为个人交易决策提供智能化支持

---

## 5. 扩展功能模块

### 5.1 模块三：投资决策记录

#### 5.1.1 交易记录管理

**F-REQ 3.1: 交易记录录入**
- 支持记录各类投资决策（买入、卖出、加仓、减仓）
- **必填字段**：
  - 标的名称（如：BTC、AAPL、黄金）
  - 操作类型（买入/卖出/加仓/减仓）
  - 投资金额（实际投入资金）
  - 决策原因（核心字段）
  - 时间（自动记录）
- **可选字段**：
  - 价格（买入/卖出价格）
  - 数量（购买数量）
- 支持添加标签，可关联知识库信息

**F-REQ 3.2: 决策原因与知识库关联**
- 录入交易记录时可引用知识库信息作为决策依据
- 实现方式：提供"关联信息"功能，用户可勾选相关条目
- 目的：建立"信息 → 决策"完整链路，便于复盘分析

**F-REQ 3.3: 交易记录查看与筛选**
- 支持时间线展示所有交易记录
- **筛选条件**：
  - 按标的筛选（如：仅显示BTC交易）
  - 按操作类型筛选（如：仅显示买入记录）
  - 按时间范围筛选（如：最近3个月）
  - 按标签筛选
- **显示字段**：标的、操作、金额、价格、决策原因摘要（前50字）、时间

**F-REQ 3.4: 持仓与盈亏统计**
- **自动统计**：
  - 每个标的的总投入金额
  - 每个标的的当前持仓（根据买卖记录计算）
  - 简单盈亏（需手动输入当前价格）
- **版本约束**: V1.0无需实时行情接入，用户手动更新价格
- 统计结果以表格或卡片形式展示

**F-REQ 3.5: 复盘功能**
- 支持为已完成交易添加复盘笔记
- **复盘内容**：
  - 决策正确性评估（成功/失败/部分成功）
  - 经验教训（自由文本）
- 复盘笔记与原交易记录关联显示

### 5.2 模块四：资产管理

#### 5.2.1 资产组合管理

**F-REQ 4.1: 资产组合总览**
- 提供资产组合总览界面，显示所有持仓资产
- **显示内容**：
  - 总资产价值（以USDT/USDC计价）
  - 各资产持仓比例（饼图或条形图）
  - 总投入金额 vs 当前价值
  - 总盈亏金额和收益率
- 支持按资产类型分类显示（股票、加密货币、贵金属等）

**F-REQ 4.2: 现金管理**
- 支持多种现金资产类型：
  - **稳定币**: USDT、USDC、DAI等
  - **法币**: USD、CNY等（可选）
- **现金记录功能**：
  - 现金流入记录（充值、收入等）
  - 现金流出记录（提现、支出等）
  - 现金余额实时计算
- **现金分配**：
  - 总现金余额显示
  - 各稳定币余额分别显示
  - 现金使用率统计

**F-REQ 4.3: 持仓管理**
- **持仓统计**：
  - 每个标的的持仓数量
  - 平均成本价格
  - 当前市场价格（手动更新）
  - 持仓价值（数量 × 当前价格）
  - 浮动盈亏（当前价值 - 成本价值）
  - 持仓收益率
- **持仓历史**：
  - 持仓变化时间线
  - 加仓/减仓记录
  - 成本价格变化

**F-REQ 4.4: 资产分类管理**
- **资产分类**：
  - 加密货币（BTC、ETH等）
  - 股票（美股、A股等）
  - 贵金属（黄金、白银等）
  - 现金资产（USDT、USDC等）
  - 其他资产
- **分类统计**：
  - 各类资产总价值
  - 各类资产占比
  - 各类资产盈亏情况

**F-REQ 4.5: 资产配置分析**
- **配置建议**：
  - 基于历史数据的资产配置建议
  - 风险分散度分析
  - 资产相关性分析
- **风险指标**：
  - 最大回撤
  - 波动率
  - 夏普比率（简化版）

### 5.3 模块五：待观察标的管理

#### 5.3.1 观察列表管理

**F-REQ 5.1: 观察列表录入**
- 支持将感兴趣标的添加到观察列表
- **必填字段**：
  - 标的名称
  - 观察原因（核心字段）
- **可选字段**：
  - 目标价格（期望买入价格）
  - 当前价格（手动更新）
  - 状态（观察中/已买入/已放弃）
  - 标签
- 支持添加备注

**F-REQ 5.2: 观察理由与知识库关联**
- 添加观察标的时可引用知识库信息作为观察依据
- 实现方式：与交易记录类似，提供"关联信息"功能
- 目的：记录观察理由，避免盲目观察

**F-REQ 5.3: 观察列表展示**
- 采用卡片式布局展示所有标的
- **卡片显示内容**：
  - 标的名称
  - 当前价格 vs 目标价格（可视化进度条）
  - 观察原因摘要（前50字）
  - 状态标签（观察中/已买入/已放弃）
  - 添加时间

**F-REQ 5.4: 状态管理与快速操作**
- 支持快速更新观察标的状态
- **状态转换**：
  - 观察中 → 已买入：点击"买入"按钮，跳转交易记录录入界面，预填充标的名称和关联信息
  - 观察中 → 已放弃：点击"放弃"按钮，可选填写放弃原因
- 已买入或已放弃的标的自动移至"历史"列表

**F-REQ 5.5: 价格提醒**
- 高亮显示已达到或低于目标价格的标的
- **版本约束**: V1.0无需实时推送通知，用户打开观察列表时自动高亮
- **可选增强**: 在观察列表顶部显示"X个标的已达到目标价"提示

**F-REQ 5.6: 观察列表筛选**
- **筛选条件**：
  - 按状态筛选（观察中/已买入/已放弃）
  - 按标签筛选
  - 按是否达到目标价筛选
- 支持标的名称搜索

## 6. 附录

### 6.1 实现说明
本文档专注于功能需求，所有技术实现细节（包括数据模型设计、技术选型、实施路线图、界面设计等）已移至独立文档 `implementation.md`，以保持需求文档的纯粹性和可读性。

### 6.2 文档版本信息
- **当前版本**: 1.0
- **最后更新**: 2024年
- **文档状态**: 需求规格说明书
- **关联文档**: implementation.md